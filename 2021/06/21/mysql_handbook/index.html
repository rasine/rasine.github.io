<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rasine.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="安装123456ubuntusudo apt-get install mysql-serversudo apt-get isntall mysql-clientsudo apt-get install libmysqlclient-devsudo netstat -tap | grep mysql  检查是否安装成功   创建用户说明:username - 你将创建的用户名, host - 指定该">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql常用操作备注">
<meta property="og:url" content="http://rasine.github.io/2021/06/21/mysql_handbook/index.html">
<meta property="og:site_name" content="Rasine Blog">
<meta property="og:description" content="安装123456ubuntusudo apt-get install mysql-serversudo apt-get isntall mysql-clientsudo apt-get install libmysqlclient-devsudo netstat -tap | grep mysql  检查是否安装成功   创建用户说明:username - 你将创建的用户名, host - 指定该">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-06-21T03:22:48.000Z">
<meta property="article:modified_time" content="2021-06-21T03:48:18.820Z">
<meta property="article:author" content="rasine">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rasine.github.io/2021/06/21/mysql_handbook/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>mysql常用操作备注 | Rasine Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Rasine Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Rasine Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Rasine Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://rasine.github.io/2021/06/21/mysql_handbook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rasine">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rasine Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mysql常用操作备注
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-06-21 11:22:48 / Modified: 11:48:18" itemprop="dateCreated datePublished" datetime="2021-06-21T11:22:48+08:00">2021-06-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ubuntu</span><br><span class="line">sudo apt-get install mysql-server</span><br><span class="line">sudo apt-get isntall mysql-client</span><br><span class="line">sudo apt-get install libmysqlclient-dev</span><br><span class="line"></span><br><span class="line">sudo netstat -tap | grep mysql  检查是否安装成功</span><br></pre></td></tr></table></figure>


<h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><p>说明:username - 你将创建的用户名, host - 指定该用户在哪个主机上可以登陆,如果是本地用户可用localhost, 如果想让该用户可以从任意远程主机登陆,可以使用通配符%. password - 该用户的登陆密码,密码可以为空,如果为空则该用户可以不需要密码登陆服务器.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &#x27;username&#x27;@&#x27;host&#x27; IDENTIFIED BY &#x27;password&#x27;; </span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">CREATE USER &#x27;dog&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;123456&#x27;; </span><br><span class="line">CREATE USER &#x27;pig&#x27;@&#x27;192.168.1.101_&#x27; IDENDIFIED BY &#x27;123456&#x27;; </span><br><span class="line">CREATE USER &#x27;pig&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;; </span><br><span class="line">CREATE USER &#x27;pig&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;&#x27;; </span><br><span class="line">CREATE USER &#x27;pig&#x27;@&#x27;%&#x27;;</span><br><span class="line"></span><br><span class="line">CREATE USER &#x27;pig&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;12345678&#x27;;</span><br><span class="line">GRANT ALL ON *.* TO &#x27;pig&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;12345678&#x27;;</span><br><span class="line">flush privileges ;</span><br></pre></td></tr></table></figure>


<h3 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h3><p>说明: privileges - 用户的操作权限,如SELECT , INSERT , UPDATE 等(详细列表见该文最后面).如果要授予所的权限则使用ALL.;databasename - 数据库名,tablename-表名,如果要授予该用户对所有数据库和表的相应操作权限则可用<em>表示, 如</em>.*. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GRANT privileges ON databasename.tablename TO &#x27;username&#x27;@&#x27;host&#x27; </span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">GRANT SELECT, INSERT ON test.user TO &#x27;pig&#x27;@&#x27;%&#x27;; </span><br><span class="line">GRANT ALL ON *.* TO &#x27;pig&#x27;@&#x27;%&#x27;; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意:用以上命令授权的用户不能给其它用户授权,如果想让该用户可以授权,用以下命令:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT privileges ON databasename.tablename TO &#x27;username&#x27;@&#x27;host&#x27; WITH GRANT OPTION; </span><br></pre></td></tr></table></figure>

<h3 id="设置与更改用户密码"><a href="#设置与更改用户密码" class="headerlink" title="设置与更改用户密码"></a>设置与更改用户密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">当前用户与需要修改密码的用户不是同一用户</span><br><span class="line">SET PASSWORD FOR &#x27;username&#x27;@&#x27;host&#x27; = PASSWORD(&#x27;newpassword&#x27;);</span><br><span class="line"></span><br><span class="line">当前用户与需要修改密码的用户是同一用户</span><br><span class="line">SET PASSWORD = PASSWORD(&quot;newpassword&quot;);</span><br><span class="line"></span><br><span class="line">例子: SET PASSWORD FOR &#x27;pig&#x27;@&#x27;%&#x27; = PASSWORD(&quot;123456&quot;); </span><br></pre></td></tr></table></figure>

<h3 id="撤销用户权限"><a href="#撤销用户权限" class="headerlink" title="撤销用户权限"></a>撤销用户权限</h3><p>说明: privilege, databasename, tablename - 同授权部分. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REVOKE privilege ON databasename.tablename FROM &#x27;username&#x27;@&#x27;host&#x27;; </span><br><span class="line"></span><br><span class="line">例子: REVOKE SELECT ON *.* FROM &#x27;pig&#x27;@&#x27;%&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令: DROP USER &#x27;username&#x27;@&#x27;host&#x27;; </span><br></pre></td></tr></table></figure>

<h3 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table table_name rename table_new_name;</span><br></pre></td></tr></table></figure>

<h3 id="显示用户权限"><a href="#显示用户权限" class="headerlink" title="显示用户权限"></a>显示用户权限</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">查看MySQL用户权限：</span><br><span class="line">show grants for 你的用户</span><br><span class="line">比如：</span><br><span class="line">show grants for root@&#x27;localhost&#x27;;</span><br><span class="line"></span><br><span class="line">select Host,User from user.user;</span><br></pre></td></tr></table></figure>


<h3 id="恢复数据"><a href="#恢复数据" class="headerlink" title="恢复数据"></a>恢复数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog --no-defaults --database=ff5 --stop-datetime=&quot;2017-04-15 21:45:00&quot; /var/lib/mysql/bak/mysql-bin.* &gt; bak_bak_2130.sql</span><br><span class="line">mysqlbinlog --no-defaults --database=ff5 --start-datatime=&quot;2017-04-15 21:50:00&quot; --stop-datetime=&quot;2017-04-15 21:55:00&quot; /var/lib/mysql/bak/mysql-bin.* &gt; bak_50_55.sql</span><br><span class="line"></span><br><span class="line">mysql -uroot -p  -f &lt; bak_1200.sql</span><br></pre></td></tr></table></figure>


<h3 id="mysql查询"><a href="#mysql查询" class="headerlink" title="mysql查询"></a>mysql查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">show full processlist;</span><br><span class="line"></span><br><span class="line">查看当前的并发数：show status like &#x27;Threads%&#x27;;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Threads_cached    | 58    |</span><br><span class="line">| Threads_connected | 57    |   ###这个数值指的是打开的连接数</span><br><span class="line">| Threads_created   | 3676  |</span><br><span class="line">| Threads_running   | 4     |   ###这个数值指的是激活的连接数，这个数值一般远低于connected数值</span><br><span class="line">+-------------------+-------+</span><br><span class="line">Threads_connected 跟show processlist结果相同，表示当前连接数。准确的来说，Threads_running是代表当前并发数</span><br><span class="line"></span><br><span class="line">查询数据库当前设置的最大连接数：show variables like &#x27;%max_connections%&#x27;;</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name   | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| max_connections | 1000  |    ###max_connections 参数可以用于控制数据库的最大连接数：</span><br><span class="line">+-----------------+-------+</span><br><span class="line"></span><br><span class="line">查询连接数：show variables like &#x27;%connect%&#x27;;</span><br><span class="line">+--------------------------+-------------------+</span><br><span class="line">| Variable_name            | Value             |</span><br><span class="line">+--------------------------+-------------------+</span><br><span class="line">| character_set_connection | latin1            | </span><br><span class="line">| collation_connection     | latin1_swedish_ci | </span><br><span class="line">| connect_timeout          | 10                | </span><br><span class="line">| init_connect             |                   | </span><br><span class="line">| max_connect_errors       | 10                | </span><br><span class="line">| max_connections          | 4000              | </span><br><span class="line">| max_user_connections     | 0                 | </span><br><span class="line">+--------------------------+-------------------+</span><br><span class="line"></span><br><span class="line">查看mysql的最大连接数：show variables like &#x27;%max_connections%&#x27;;</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name  | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| max_connections | 151  |</span><br><span class="line">+-----------------+-------+</span><br><span class="line"></span><br><span class="line">服务器响应的最大连接数：show global status like &#x27;Max_used_connections&#x27;;</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Max_used_connections | 2   |</span><br><span class="line">+----------------------+-------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">查询日志目录：select @@log_error;</span><br><span class="line">设置校验强度：</span><br><span class="line">set global validate_password_policy=0;</span><br><span class="line">set global validate_password_policy=1;</span><br><span class="line">set global validate_password_policy=2;</span><br><span class="line"></span><br><span class="line">查询校验字符最小长度：</span><br><span class="line">select @@validate_password_length;</span><br><span class="line"></span><br><span class="line">flush  privileges ;</span><br><span class="line">然后重新连接数据库</span><br></pre></td></tr></table></figure>


<h3 id="常用变量有"><a href="#常用变量有" class="headerlink" title="常用变量有"></a>常用变量有</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Aborted_clients 由于客户没有正确关闭连接已经死掉，已经放弃的连接数量。</span><br><span class="line">Aborted_connects 尝试已经失败的MySQL服务器的连接的次数。</span><br><span class="line">Connections 试图连接MySQL服务器的次数。</span><br><span class="line">Created_tmp_tables 当执行语句时，已经被创造了的隐含临时表的数量。</span><br><span class="line">Delayed_insert_threads 正在使用的延迟插入处理器线程的数量。</span><br><span class="line">Delayed_writes 用INSERT DELAYED写入的行数。</span><br><span class="line">Delayed_errors 用INSERT DELAYED写入的发生某些错误(可能重复键值)的行数。</span><br><span class="line">Flush_commands 执行FLUSH命令的次数。</span><br><span class="line">Handler_delete 请求从一张表中删除行的次数。</span><br><span class="line">Handler_read_first 请求读入表中第一行的次数。</span><br><span class="line">Handler_read_key 请求数字基于键读行。</span><br><span class="line">Handler_read_next 请求读入基于一个键的一行的次数。</span><br><span class="line">Handler_read_rnd 请求读入基于一个固定位置的一行的次数。</span><br><span class="line">Handler_update 请求更新表中一行的次数。</span><br><span class="line">Handler_write 请求向表中插入一行的次数。</span><br><span class="line">Key_blocks_used 用于关键字缓存的块的数量。</span><br><span class="line">Key_read_requests 请求从缓存读入一个键值的次数。</span><br><span class="line">Key_reads 从磁盘物理读入一个键值的次数。</span><br><span class="line">Key_write_requests 请求将一个关键字块写入缓存次数。</span><br><span class="line">Key_writes 将一个键值块物理写入磁盘的次数。</span><br><span class="line">Max_used_connections 同时使用的连接的最大数目。</span><br><span class="line">Not_flushed_key_blocks 在键缓存中已经改变但是还没被清空到磁盘上的键块。</span><br><span class="line">Not_flushed_delayed_rows 在INSERT DELAY队列中等待写入的行的数量。</span><br><span class="line">Open_tables 打开表的数量。</span><br><span class="line">Open_files 打开文件的数量。</span><br><span class="line">Open_streams 打开流的数量(主要用于日志记载）</span><br><span class="line">Opened_tables 已经打开的表的数量。</span><br><span class="line">Questions 发往服务器的查询的数量。</span><br><span class="line">Slow_queries 要花超过long_query_time时间的查询数量。</span><br><span class="line">Threads_connected 当前打开的连接的数量。</span><br><span class="line">Threads_running 不在睡眠的线程数量。</span><br><span class="line">Uptime 服务器工作了多少秒。</span><br></pre></td></tr></table></figure>


<h3 id="mysql监控"><a href="#mysql监控" class="headerlink" title="mysql监控"></a>mysql监控</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">检测mysql server是否正常提供服务</span><br><span class="line">mysqladmin -u sky -ppwd -h localhost ping</span><br><span class="line"></span><br><span class="line">获取mysql当前的几个状态值</span><br><span class="line">mysqladmin -u sky -ppwd -h localhost status</span><br><span class="line"></span><br><span class="line">获取数据库当前的连接信息</span><br><span class="line">mysqladmin -u sky -ppwd -h localhost processlist</span><br><span class="line"></span><br><span class="line">获取当前数据库的连接数</span><br><span class="line">mysql -u root -p123456 -BNe “select host,count(host) from processlist group by host;” information_schema</span><br><span class="line"></span><br><span class="line">显示mysql的uptime</span><br><span class="line">mysql -e”SHOW STATUS LIKE ‘%uptime%’”|awk ‘/ptime/&#123; calc = NF/3600;printNF/3600;print(NF-1), calc”Hour” &#125;’</span><br><span class="line"></span><br><span class="line">查看数据库的大小</span><br><span class="line">mysql -u root -p123456-e ‘select table_schema,round(sum(data_length+index_length)/1024/1024,4) from information_schema.tables group by table_schema;’</span><br><span class="line"></span><br><span class="line">查看某个表的列信息</span><br><span class="line">mysql -u –password= -e “SHOW COLUMNS FROM</span><br><span class="line"></span><br><span class="line">” | awk ‘&#123;print 1&#125;&#x27; | tr &quot;\n&quot; &quot;,&quot; | sed &#x27;s/,1&#125;&#x27; | tr &quot;\n&quot; &quot;,&quot; | sed &#x27;s/,//g’</span><br><span class="line">执行mysql脚本</span><br><span class="line">mysql -u user-name -p password &lt; script.sql</span><br><span class="line"></span><br><span class="line">mysql dump数据导出</span><br><span class="line">mysqldump -uroot -T/tmp/mysqldump test test_outfile –fields-enclosed-by=\” –fields-terminated-by=,</span><br><span class="line"></span><br><span class="line">mysql数据导入</span><br><span class="line">mysqlimport –user=name –password=pwd test –fields-enclosed-by=\” –fields-terminated-by=, /tmp/test_outfile.txt </span><br><span class="line">LOAD DATA INFILE ‘/tmp/test_outfile.txt’ INTO TABLE test_outfile FIELDS TERMINATED BY ‘”’ ENCLOSED BY ‘,’;</span><br><span class="line"></span><br><span class="line">mysql进程监控</span><br><span class="line">ps -ef | grep “mysqld_safe” | grep -v “grep” </span><br><span class="line">ps -ef | grep “mysqld” | grep -v “mysqld_safe”| grep -v “grep”</span><br><span class="line"></span><br><span class="line">查看当前数据库的状态</span><br><span class="line">mysql -u root -p123456 -e ‘show status’</span><br><span class="line"></span><br><span class="line">mysqlcheck 工具程序可以检查(check),修 复( repair),分 析( analyze)和优化(optimize)MySQL Server 中的表</span><br><span class="line">mysqlcheck -u root -p123456 –all-databases</span><br><span class="line"></span><br><span class="line">mysql qps查询 QPS = Questions(or Queries) / Seconds</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Questions”’ </span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Queries”’</span><br><span class="line"></span><br><span class="line">mysql Key Buffer 命中率 key_buffer_read_hits = (1 - Key_reads / Key_read_requests) * 100% key_buffer_write_hits= (1 - Key_writes / Key_write_requests) * 100%</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Key%”’</span><br><span class="line"></span><br><span class="line">mysql Innodb Buffer 命中率 innodb_buffer_read_hits=(1-Innodb_buffer_pool_reads/Innodb_buffer_pool_read_requests) * 100%</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Innodb_buffer_pool_read%”’</span><br><span class="line"></span><br><span class="line">mysql Query Cache 命中率 Query_cache_hits= (Qcache_hits / (Qcache_hits + Qcache_inserts)) * 100%</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Qcache%”’</span><br><span class="line"></span><br><span class="line">mysql Table Cache 状态量</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Open%”’</span><br><span class="line"></span><br><span class="line">mysql Thread Cache 命中率 Thread_cache_hits = (1 - Threads_created / Connections) * 100% 正常来说,Thread Cache 命中率要在 90% 以上才算比较合理。</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Thread%”’</span><br><span class="line"></span><br><span class="line">mysql 锁定状态:锁定状态包括表锁和行锁两种,我们可以通过系统状态变量获得锁定总次数,锁定造成其他线程等待的次数,以及锁定等待时间信息</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “%lock%”’</span><br><span class="line"></span><br><span class="line">mysql 复制延时量 在slave节点执行</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW SLAVE STATUS’</span><br><span class="line"></span><br><span class="line">mysql Tmp table 状况 Tmp Table 的状况主要是用于监控 MySQL 使用临时表的量是否过多,是否有临时表过大而不得不从内存中换出到磁盘文件上</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Created_tmp%”’</span><br><span class="line"></span><br><span class="line">mysql Binlog Cache 使用状况:Binlog Cache 用于存放还未写入磁盘的 Binlog 信 息 。</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Binlog_cache%”’</span><br><span class="line"></span><br><span class="line">mysql nnodb_log_waits 量:Innodb_log_waits 状态变量直接反应出 Innodb Log Buffer 空间不足造成等待的次数</span><br><span class="line">mysql -u root -p123456 -e ‘SHOW /!50000 GLOBAL / STATUS LIKE “Innodb_log_waits’</span><br></pre></td></tr></table></figure>

<h3 id="实时监控SQL语句的执行频率"><a href="#实时监控SQL语句的执行频率" class="headerlink" title="实时监控SQL语句的执行频率"></a>实时监控SQL语句的执行频率</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -Pxxxx -uxxxx -pxxxx -hxxxx -r -i 1 ext |\</span><br><span class="line">awk -F&quot;|&quot; \</span><br><span class="line">&quot;BEGIN&#123; count=0; &#125;&quot;\</span><br><span class="line">&#x27;&#123; if($2 ~ /Variable_name/ &amp;&amp; ++count == 1)&#123;\</span><br><span class="line">    print &quot;----------|---------|--- MySQL Command Status --|----- Innodb row operation ----|-- Buffer Pool Read --&quot;;\</span><br><span class="line">    print &quot;---Time---|---QPS---|select insert update delete|  read inserted updated deleted|   logical    physical&quot;;\</span><br><span class="line">&#125;\</span><br><span class="line">else if ($2 ~ /Queries/)&#123;queries=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Com_select /)&#123;com_select=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Com_insert /)&#123;com_insert=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Com_update /)&#123;com_update=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Com_delete /)&#123;com_delete=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_rows_read/)&#123;innodb_rows_read=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_rows_deleted/)&#123;innodb_rows_deleted=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_rows_inserted/)&#123;innodb_rows_inserted=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_rows_updated/)&#123;innodb_rows_updated=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_buffer_pool_read_requests/)&#123;innodb_lor=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Innodb_buffer_pool_reads/)&#123;innodb_phr=$3;&#125;\</span><br><span class="line">else if ($2 ~ /Uptime / &amp;&amp; count &gt;= 2)&#123;\</span><br><span class="line">  printf(&quot; %s |%9d&quot;,strftime(&quot;%H:%M:%S&quot;),queries);\</span><br><span class="line">  printf(&quot;|%6d %6d %6d %6d&quot;,com_select,com_insert,com_update,com_delete);\</span><br><span class="line">  printf(&quot;|%6d %8d %7d %7d&quot;,innodb_rows_read,innodb_rows_inserted,innodb_rows_updated,innodb_rows_deleted);\</span><br><span class="line">  printf(&quot;|%10d %11d\n&quot;,innodb_lor,innodb_phr);\</span><br><span class="line">&#125;&#125;&#x27;</span><br></pre></td></tr></table></figure>





<ul>
<li><p>用户管理　　</p>
</li>
<li><p>创建用户<br>  create user ‘用户名‘@’IP地址’ identified by ‘密码’;</p>
</li>
<li><p>删除用户<br>  drop user ‘用户名‘@’IP地址’;</p>
</li>
<li><p>修改用户<br>  rename user ‘用户名‘@’IP地址’; to ‘新用户名‘@’IP地址’;</p>
</li>
<li><p>修改密码<br>  set password for ‘用户名‘@’IP地址’ = Password(‘新密码’)</p>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/mysql/" rel="tag"># mysql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/06/21/shell_cmd/" rel="prev" title="shell基础操作">
      <i class="fa fa-chevron-left"></i> shell基础操作
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="nav-number">2.</span> <span class="nav-text">创建用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%88%E6%9D%83"><span class="nav-number">3.</span> <span class="nav-text">授权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E4%B8%8E%E6%9B%B4%E6%94%B9%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-number">4.</span> <span class="nav-text">设置与更改用户密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%92%A4%E9%94%80%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="nav-number">5.</span> <span class="nav-text">撤销用户权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7"><span class="nav-number">6.</span> <span class="nav-text">删除用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D"><span class="nav-number">7.</span> <span class="nav-text">修改表名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="nav-number">8.</span> <span class="nav-text">显示用户权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="nav-number">9.</span> <span class="nav-text">恢复数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.</span> <span class="nav-text">mysql查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%8F%98%E9%87%8F%E6%9C%89"><span class="nav-number">11.</span> <span class="nav-text">常用变量有</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E7%9B%91%E6%8E%A7"><span class="nav-number">12.</span> <span class="nav-text">mysql监控</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A2%91%E7%8E%87"><span class="nav-number">13.</span> <span class="nav-text">实时监控SQL语句的执行频率</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rasine</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rasine</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
